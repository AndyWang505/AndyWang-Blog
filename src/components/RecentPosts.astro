---
import { getCollection } from 'astro:content';
import FormattedDate from './FormattedDate.astro';

const posts = await getCollection('blog');
const recentPosts = posts
  .sort((a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 5);
---

<div class="w-full rounded-lg bg-white dark:bg-zinc-900 drop-shadow p-6">
  <h3 class="text-md font-bold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider">
    RECENT POSTS
  </h3>
  <ul>
    {
      recentPosts.map((post: any) => (
        <li class="border-b border-dashed dark:border-zinc-700 py-2 last:border-0">
          <a href={`/post/${post.slug}/`} class="flex items-center gap-2">
            {post.data.heroImage && (
              <img src={post.data.heroImage} alt="" class="w-12 h-12 rounded-md object-cover" />
            )}
            <div>
              <h4 class="text-sm mb-1 dark:text-neutral-200 font-normal hover:underline">
                {post.data.title}
              </h4>
              <div class="flex items-center text-xs text-neutral-500 dark:text-neutral-400">
                <FormattedDate date={post.data.pubDate} />
              </div>
            </div>
          </a>
        </li>
      ))
    }
  </ul>
</div>
