---
import Layout from '../../layouts/Layout.astro';
import Aside from '../../layouts/Aside.astro';
import MobileNav from '../../components/MobileNav.astro';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout>
  <!-- Main content wrapper with fuwari-style layout -->
  <div class="relative max-w-[var(--page-width)] mx-auto px-0 md:px-4">
    <div class="transition duration-700 w-full grid grid-cols-[17.5rem_auto] grid-rows-[auto_1fr_auto] lg:grid-rows-[auto] mx-auto gap-4 px-0 md:px-4">
      <Aside />
      <!-- mobile nav -->
      <MobileNav />
      <main class="col-span-2 lg:col-span-1 overflow-hidden">
        <div class="onload-animation">
          <section class="dark:bg-zinc-800 bg-white shadow-md rounded-lg overflow-hidden py-6">
      <div class="text-2xl mb-4 ml-6 md:ml-12 dark:text-neutral-200">
        <h2>Archive</h2>
        <h3 class="text-xl">共 {posts.length} 筆文章</h3>
      </div>
      <ul class="pl-10 md:pl-16">
        {
          posts.map((post) => (
            <li class="mb-2 list-disc dark:text-neutral-200">
              <a href={`/post/${post.slug}/`}>
                <p class="text-sm text-neutral-400 inline-block">
                  <FormattedDate date={post.data.pubDate} />
                </p>
                <h4 class="ml-2 inline-block hover:underline hover:underline-offset-2">
                  {post.data.title}
                </h4>
              </a>
            </li>
          ))
        }
          </ul>
          </section>
        </div>
      </main>
    </div>
  </div>
</Layout>
